<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %} {% endblock %}</title>
    {% load static %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hamburgers/1.2.1/hamburgers.min.css"
        integrity="sha512-+mlclc5Q/eHs49oIOCxnnENudJWuNqX5AogCiqRBgKnpoplPzETg2fkgBFVC6WYUVxYYljuxPNG8RE7yBy1K+g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="{% static 'vendor/fontawesome-free/css/all.min.css' %}" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/style-commons.css' %}">
    <script src="{% static 'js/pageIndex.js' %}"></script>
    {% block urls %} {% endblock %}
</head>

<body>

    <a href="https://wa.me/+573006280468" target="_blank" class="whatsapp-button">
        <i class="fab fa-whatsapp"></i>
    </a>

    <div class="main-menu" id="main-menu">
        <ul class="main-menu-list">
            <li class="menu-item logo">
                <a href="{% url 'pageHome' %}">
                    <img src="{% static 'img/gorille.png' %}" class="logo" alt="Logo de Brutálity">
                </a>
            </li>
            <li class="menu-item nav">
                <div class="container-search">
                    <input placeholder="Realizar búsqueda..." type="text" name="search" class="search"
                        id="search-input">
                    <i class="fas fa-times search-clear-icon" id="search-clear"></i>
                </div>
                <!-- toggle -->
                <div class="search-result-cont">
                    <div id="toggle-main-search" class="search-result"></div>
                </div>
                <div class="menu-item productos mt-1" id="toggle-submain-products">
                    Suplementos
                    <!-- <i class="fas fa-arrow-right"></i> -->
                </div>
            </li>
            <hr class="divider">
            <li class="menu-item info">
                <a href="#" class="menu-link">
                    <i class="fas fa-info-circle icon"></i> Sobre Brutality
                </a>
                <a href="#" class="menu-link">
                    <i class="fas fa-shopping-cart icon"></i> ¿Cómo comprar?
                </a>

                <span class="menu-contact">
                    <i class="fas fa-envelope icon"></i> brutality@gmail.com
                </span>
                <div class="login-item">
                    <div class="social-icons">
                        <a href="#" class="mx-2"><i class="fab fa-instagram icon"></i></a>
                        <a href="#"><i class="fab fa-whatsapp icon"></i></a>
                    </div>
                    <a href="#" class="login-button">Login</a>
                </div>
            </li>
        </ul>
    </div>
    <div id="options-submain-products" class="menu-options">
        <i class="fas fa-arrow-left cerrar-icon" id="close-submain-options"></i>
        <div class="menu-options-item" id="toggle-main-productos">
            Productos <i class="fas fa-chevron-down"></i>
        </div>
        <ul id="main-options-products" class="options-menu-list productos">
            {% for categoria in categorias %}
            <li>{{ categoria.nombre_categoria }}:
                <ul>
                    {% for producto in categoria.productos_set.all %}
                    <li class="menu-list-item" data-tipo="producto">{{ producto.nombre_producto }}</li>
                    {% endfor %}
                </ul>
            </li>
            {% endfor %}
        </ul>
        <hr class="divider">
        <div class="menu-options-item" id="toggle-main-marcas">
            Marcas <i class="fas fa-chevron-down"></i>
        </div>
        <ul id="main-options-marcas" class="options-menu-list marcas">
            {% for marca in marcas %}
            <li class="menu-list-item" data-tipo="marca">{{ marca.nombre_marca }}</li>
            {% endfor %}
        </ul>
        <hr class="divider">
        <div class="menu-options-item" id="toggle-main-categorias">
            Categorias <i class="fas fa-chevron-down"></i>
        </div>
        <ul id="main-options-categorias" class="options-menu-list categorias">
            {% for categoria in categorias %}
            <li class="menu-list-item" data-tipo="categoria">{{ categoria.nombre_categoria }}</li>
            {% endfor %}
        </ul>
    </div>

    <header class="main-header">
        <nav class="header-navigation">
            <div class="social-icons">
                <a href="#"><i class="fab fa-instagram"></i></a>
            </div>
            <a href="{% url 'pageHome' %}">
                <img src="{% static 'img/gorille.png' %}" class="logo" alt="Logo de Brutálity">
            </a>
            <label class="hamburger">
                <input type="checkbox" id="hamburgerCheckbox">
                <svg viewBox="0 0 32 32">
                    <path class="line line-top-bottom"
                        d="M27 10 13 10C10.8 10 9 8.2 9 6 9 3.5 10.8 2 13 2 15.2 2 17 3.8 17 6L17 26C17 28.2 18.8 30 21 30 23.2 30 25 28.2 25 26 25 23.8 23.2 22 21 22L7 22">
                    </path>
                    <path class="line" d="M7 16 27 16"></path>
                </svg>
            </label>
        </nav>
        {% block extraHeader %}{% endblock %}
    </header>
    {% block catalog-section %}
    <div class="catalog-section">
        <select name="sort" id="sort" class="catalog-select">
            <option value="all" class="sort-option">Ver todo</option>
            <option value="best-sellers" class="sort-option">Más vendidos</option>
            <option value="high-price" class="sort-option">Mayor precio</option>
            <option value="low-price" class="sort-option">Menor precio</option>
        </select>
        <div class="view-options">
            <a href="#" aria-label="detalle de la lista de productos" id="list"><i class="fas fa-th-list fa-lg"></i></a>
            <a href="#" aria-label="lista productos" id="grid"><i class="fas fa-th-large fa-lg"></i></a>
        </div>
    </div>
    {% endblock %}
</body>


{% block body %}{% endblock %}


<footer>
    <p>&copy; 2023 Brutálity</p>
</footer>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
    $(document).on("input", ".search", function () {
        let search = $(this).val();

        if (search.length >= 2) {
            $.ajax({
                url: "{% url 'search_products' %}",
                method: 'GET',
                data: { search: search },
                success: function (data) {
                    if (data.success) {
                        if (data.data.length > 0) {
                            $("#toggle-main-search").empty();
                            $.each(data.data, function (index, p) {
                                $("#toggle-main-search").addClass("is-active");
                                var productList =
                                    '<div class="search-card">' +
                                    '<a href="{% url "pageDetails" %}?producto_id=' + p.id_producto + '">' +
                                    '<div class="search-image">' +
                                    '<img class="img-fluid" src="/media/landingproducts/products/' + p.iProductImg_name + '" alt="Imagen"></div>' +
                                    '<p class="search-title">' + p.nombre_producto + '</p></a></div >';
                                $("#toggle-main-search").append(productList);
                            });
                        } else {
                            $("#toggle-main-search").empty();
                            $("#toggle-main-search").removeClass("is-active");
                        }
                    }
                }
            });
        } else {
            $("#toggle-main-search").empty();
            $("#toggle-main-search").removeClass("is-active");
        }
    });

    $("#search-clear").on("click", function () {
        $("#search-input").val("");
        $("#toggle-main-search").empty();
        $("#toggle-main-search").removeClass("is-active");
    });
</script>

<script>
    const toggleProductos = document.getElementById("toggle-main-productos");
    const toggleMarcas = document.getElementById("toggle-main-marcas");
    const toggleCategorias = document.getElementById("toggle-main-categorias");
    const mainOptionsProductos = document.getElementById("main-options-products");
    const mainOptionsMarcas = document.getElementById("main-options-marcas");
    const mainOptionsCategorias = document.getElementById("main-options-categorias");

    const iconProductos = toggleProductos.querySelector("i");
    const iconMarcas = toggleMarcas.querySelector("i");
    const iconCategorias = toggleCategorias.querySelector("i");

    const closeSubMainOptions = document.getElementById('close-submain-options');

    closeSubMainOptions.addEventListener('click', function () {
        // Cerrar opciones
        mainOptionsProductos.classList.remove("is-active");
        mainOptionsMarcas.classList.remove("is-active");
        mainOptionsCategorias.classList.remove("is-active");
        // Volver iconos a su estado original
        iconProductos.classList.remove("fa-chevron-up");
        iconProductos.classList.add("fa-chevron-down");
        iconMarcas.classList.remove("fa-chevron-up");
        iconMarcas.classList.add("fa-chevron-down");
        iconCategorias.classList.remove("fa-chevron-up");
        iconCategorias.classList.add("fa-chevron-down");
    });

    function toggleActiveClass(element, iconElement) {
        element.classList.toggle("is-active");
        iconElement.classList.toggle("fa-chevron-up");
        iconElement.classList.toggle("fa-chevron-down");
    }

    toggleProductos.addEventListener("click", function () {
        toggleActiveClass(mainOptionsProductos, iconProductos);
    });

    toggleMarcas.addEventListener("click", function () {
        toggleActiveClass(mainOptionsMarcas, iconMarcas);
    });

    toggleCategorias.addEventListener("click", function () {
        toggleActiveClass(mainOptionsCategorias, iconCategorias);
    });


</script>
<!-- 
<script>
    const menuListItems = document.querySelectorAll('.menu-list-item');

    menuListItems.forEach((menuItem) => {
        menuItem.addEventListener('click', function () {
            const itemName = menuItem.textContent;
            const tipo = menuItem.getAttribute('data-tipo');

            $.ajax({
                url: '#',
                type: 'POST',
                data: { itemName: itemName, tipo: tipo },
                success: function (response) {
                    console.log('Tipo:', tipo);
                }
            });
        });
    });
</script> -->

</html>