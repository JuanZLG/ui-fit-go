{% extends "baseInterface.html" %}

{% block title %} Ventas {% endblock %}

{% block body %}

<head>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/HomeVentas.css' %}">
</head>


<center>
    <h1 class="modtitles">Gestión de Ventas</h1>
</center>
<br>
<div class="card mb-4">
    <div class="card-header py-3 d-flex justify-content-between align-items-center">
        <div class="d-flex flex-row">
            <span class="mx-2">
                <a href="{% url 'crear_venta' %}" class="btn btn-succes btn-adder btn-lg" data-toggle="tooltip"
                    data-placement="top" title="Crear una Venta">
                    <i class="fa-solid fa-plus mr-2"></i><span class="text"
                        style="font-weight: 600; font-size: 16px;">Agregar Venta</span>
                </a>
            </span>
        </div>

        <div class="d-flex align-items-center mx-2">
            <a href="#" class="btn btn-danger btn-dash btn-lg" data-toggle="tooltip" data-placement="top"
                title="Descargar PDF con Registros">
                <i class="fa-solid fa-download mr-2"></i><span class="text"
                    style="font-weight: 600; font-size: 16px;">Generar Informe</span>
            </a>
        </div>
    </div>
</div>

<div class="card shadow mb-4">
    <div class="card-header py-4">
        <div class="table-responsive">
            <table class="table table-bordered  mx-auto text-center" id="dataTable" cellspacing="3" style="overflow-y: auto;
            max-height: 400px;">
                <thead class="theads">
                    <tr>
                        <th>Fecha de Registro</th>
                        <th>Cliente</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for venta in ventas %}
                    <tr class="{% if venta.estado == 0 %}inactivo{% endif %}">
                        <td>{{ venta.fechareg }}</td>
                        <td class="d-flex">{{ venta.id_cliente.nombres }} {{ venta.id_cliente.apellidos }}</td>
                        <td>
                            <button data-toggle="tooltip" data-placement="right" title="Cambiar de Estado"
                                class="cambiar-estado statusbutton mr-2 {% if venta.estado == 1 %}active-status{% else %}inactive-status{% endif %}"
                                data-venta-id="{{ venta.id_venta}}"
                                data-nuevo-estado="{% if venta.estado == 1 %}0{% else %}1{% endif %}" data-url-state="{% url 'cambiarEstadoVentas' %}">
                                {% if venta.estado == 1 %}Activo{% else %}Inactivo{% endif %}
                            </button>
                            <button data-toggle="tooltip" data-placement="right" title="Ver Detalles" type="button"
                                class="btn btn-sm btn-primary verVenta ml-2" data-venta-id="{{ venta.id_venta }}" data-url-details="{% url 'verDetallesVenta' %}" >
                                <i class="fa-solid fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
</div>




<div class="modal-backdrop"></div>

<dialog id="verDetallesDialog" class="ventaDialog dragHandle">
    <form method="dialog">
        <div class="modal-container-header">
            <div class="estadoVentaCircle {% if venta.estado == 1 %}activo{% else %}inactivo{% endif %}"></div>
            <h2>Información de la venta</h2>
            <button class="cerrar-venta" type="button" id="cerrarDetallesVenta">
                <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0 0h24v24H0z" fill="none"></path>
                    <path
                        d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"
                        fill="currentColor"></path>
                </svg>
            </button>
        </div>
        <div class="cont-detalle-header font-weight-bold">
            <p class="float-right">Fecha de venta: <span id="fechareg"></span></p>
            <p>Cliente: <span id="cliente"></span></p>
            <p>Documento: <span id="documento"></span></p>
        </div>
        <div class="linea-detalle mb-2">
            <h3>Detalles de la Venta:</h3>
        </div>
        <table class="table tabla-detalles">
            <thead class="text-center">
                <tr>
                    <th style="width: 30%;">Producto</th>
                    <th style="width: 30%;">Precio Unitario</th>
                    <th style="width: 10%;">Cantidad</th>
                    <th style="width: 30%;">Total Producto</th>
                </tr>
            </thead>
            <tbody id="modalDetallesVenta">
            </tbody>
        </table>
        <div class="d-flex justify-content-end mt-2">
            <span class="font-weight-bold total-venta">TOTAL:<span id="totalVenta"></span></span>
        </div>
    </form>
</dialog>


<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="{% static 'js/indexSales.js' %}"></script>

{% endblock %}